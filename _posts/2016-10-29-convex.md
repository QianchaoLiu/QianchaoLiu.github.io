---
layout: post
title:  "convex optimization"
date:   2016-10-29 00:00:04
categories: liuqianchao update
---


### 1. 凸优化问题  

&emsp; 在求解问题时，我们常常会遇到求函数$$f: \mathbb{R}^n \rightarrow \mathbb{R}$$的最小值（或最大值）问题，当该函数属于凸优化问题时，我们能够在多项式时间内求解出问题的答案，因此我们常常拿凸优化问题做文章。下面我们介绍凸优化问题的相关概念。   

### 2. 相关概念   

&emsp; **凸集**：一个集合$$C$$，对于任意$$x \in C$$,$$y \in C$$，如果有$$0 \leq \theta \leq 1$$:

$$\theta x + (1-\theta)y \in C$$

&emsp; 那么称集合C为凸集(Convex Set)。其物理意义是，集合内任意两点连线上的点仍在集合内。对于$$\lambda_1 x_1 + ... + \lambda_m x_m = x$$称为凸组合（convex combination），其中$$\sum_i^m \lambda_i = 1$$并且$$\lambda_i \geq 0$$。

&emsp; **多面体**（polyhedra）。或者称为polyhedral set，是指对于矩阵$$A \in \mathbb R^{m \times n}$$, 向量$$b \in \mathbb R ^m$$。有$$\{x \in \mathbb R^n, Ax \leq b \}$$。 polyhedra是由多个hyper plane围成的（多个hyper space的交集）。

&emsp; 需要注意，hyper plane和hyper space都是凸集。

&emsp; 当polyhedra被额外限定$$x\geq 0$$时，其方向有较为特殊的性质：对于$$P=\{x\in \mathbb R:Ax \leq b, x \geq 0\}
$$，其方向$$d$$满足：$$\{Ad \leq 0, d \geq 0, d \neq 0\}$$

&emsp; **射线**(Ray)，用$$x_0 \in \mathbb R^n$$ 表示点，$$d \in \mathbb R^n$$向量表示方向。则用$$x_0$$和$$d$$表示的ray，称为ray，记成$$\{x \mid x = x_0 + \lambda d, \lambda \geq 0\}$$。需要注意，包含ray的图集是unbounded convex set。

&emsp; 一类特殊的unbounded convex set是**锥**(cone)。对于任意的$$x \in C$$，如果有$$\lambda \geq 0 $$，则$$\lambda x\in C$$，则称$$C$$是cone。需要注意cone未必都是凸集。需要注意，每个cone都包含它的原点。

&emsp; **极点**(extreme points)，$$C$$为凸集，如果不存在$$x_1$$,$$x_2$$($$x_1 \neq x_0, x_2 \neq x_0$$),使得$$x_0 = \lambda x_1 + (1-\lambda)x_2$$，对于$$\lambda \in (0,1)$$，则称$$x_0$$为极点。

&emsp; 对于凸集，其极点都在边界点（boundary points）上。

&emsp; **方向**，凸集$$C$$，如果对于所有的$$x_0 \in C$$，如果有从$$x_0$$出发的射线，对于任意$$\lambda \geq 0$$有，

$$\{x:x=x_0 +\lambda d, \lambda \geq 0 \} \subset C$$

&emsp; **极方向**(extreme direction)，如果一个方向$$d$$，不能用其他两个不相同的方向$$d_1$$,$$d_2$$表示，则称该方向为极方向。用数学符号表示，对于$$C \subset \mathbb R^n$$。不存在$$d_1$$,$$d_2$$，使得对于标量$$\lambda_1>0$$，$$\lambda_2>0$$：

$$d = \lambda_1 d_1 + \lambda_2 d_2$$

&emsp; 需要注意，一个方向是极方向的充要条件是$$d$$是多面体$$D$$的一个极点。

&emsp; **卡拉西奥多里定理**(Caratheodory Characterization Theorem)，对于正象限的多面体（线性规划中的可行域），有有限个、且至少又一个极点。或者对于$$n$$维空间，用最多$$n+1$$个点就能表示集合内的任意点。

&emsp; 对于非空unbounded多面体$$P$$，如果$$P$$有极点$$x_1...x_k$$，极方向$$d_1...d_l$$，如果$$x \in P$$，则存在常数$$\lambda_1...\lambda_k$$和$$\mu_1...\mu_l$$，使得：

$$x = \sum_{i=1}^{k} \lambda_i x_i + \sum_{j=1}^{l} \mu_j d_j$$

&emsp; **凸函数**，如果对于函数$$f: \mathbb{R}^n \rightarrow \mathbb{R}$$，其定义域为图集，并且对于$$0\leq \theta \leq 1$$：   

$$f(\theta x + (1-\theta) y) \leq \theta f(x) + (1-\theta) f(y)$$

&emsp; 并且对于$$0\leq \theta \leq 1$$, $$x_1 \neq x_2$$，有：

$$f(\theta x + (1-\theta) y) < \theta f(x) + (1-\theta) f(y)$$

&emsp; 一些性质：1.如果$$f(x)$$是凹函数(concave function)，则$$-f(x)$$是凸函数(convex function)。2. $$f_1(x)，f_2(x)$$均为凸函数，则对于$$\forall \lambda_1,\lambda_2>0$$，有$$\lambda_1 f_1(x) + \lambda_2 f_2(x)$$仍是凸函数; $$Max(f_1(x),f_2(x))$$仍是凸函数。并且上述两个定义均可以推广到有限个凸函数的组合。

&emsp; 对于非空集合$$S$$,以及函数$$f:S\rightarrow$$：$$x^* \in R^n, d\in R^n, d \neq 0$$，对任意的$$\lambda>0$$有$$x^* +\lambda d \in S$$，则定义**方向导数**(dirctional derivative):$$f^{'}(x^{*};d) = \lim_{\lambda>0+}\frac{f(x^{*}+\lambda d) - f(x^{*})}{\lambda}$$

&emsp; 对于非空集合$$S$$,以及函数$$f:S\rightarrow$$，$$f$$的上镜图(epigraph) $$epi f$$ 是$$R^{n+1}$$的子集:$$\{(x,y), x\in S, y\in R, y \geq f(x)\}$$，下镜图为$$<$$。

&emsp; 性质：$$f$$是凸函数的充要条件是：上镜图为凸集。

&emsp; 次梯度(subgradients): 凸集$$S$$，凸函数$$f$$，凸函数在集合$$S$$内的一个点$$x^{*}$$处的次梯度:   $$\xi$$:

$$f(x) \geq f(x^{*}) + \xi^{T}(x-x^{*})$$

&emsp; 注意到，$$\Delta_x^2 f(x) \geq 0$$


### 3. Linear Programming

&emsp; 对于LP问题，其标准形式表达如下:

$$min\ C^{T}X$$

$$s.t. AX =b $$

$$X \geq 0$$

&emsp; 定理1，对于存在direction的polyhedra，其存在a finite optimal solution的条件:$$C^{T}d_{j} \geq 0$$，其中$$d_j$$是extreme direction。

&emsp; Algorithm1，（原始）单纯形法:

- 找到一组BFS
- 判断其是否最优
- 如果是,停止迭代；否则，调整BFS,继续迭代。

&emsp; 由$$AX=b$$，可以得到:

$$(B\ N）
\begin{bmatrix}
   X_B \\
   X_N 
  \end{bmatrix} 
= b$$

&emsp; 即$$BX_B + NX_N = b$$, 由于$$B$$可逆，故$$X_B = B^{-1}b - B^{-1}NX_N$$。   
&emsp; $$z = CX = (C_B C_N) \begin{bmatrix}
   X_B \\
   X_N 
  \end{bmatrix} = C_BX_B +C_NX_N = C_B(B^{-1}b - B^{-1}NX_N) + C_NX_N = C_{B}B^{-1}b + (C_{N} - C_{B}B^{-1}N)X_N$$

&emsp; 其中$$C_{N} - C_{B}B^{-1}N$$作为进基检验数；出基检验数为$$\frac{B^{-1}b}{B^{-1}p_i}$$, 其中$$p_i$$为进基列；最小的出基检验数对应原本基的行，出基；   

### 4. Non-linear Programming

&emsp; NLP, **非线形规划**，这里的非线性既可以是目标函数（比如垄断市场下企业利润的函数：价格乘以产量，其中价格又是产量的函数，故利润是产量的二次函数），也可以是约束(无约束，线性约束，二次约束，凸约束，非凸约束等)；

&emsp; 可行方向(Feasible direction)，对于点$$x \in \Omega$$, 如果存在$$a^*$$，有$$\forall a \in(0,a^*)$$, $$x+ad \in \Omega$$, 则称d是可行方向。由定义可知，在集合$$\Omega$$内的点，任意方向都是可行方向；而对于boundary上的点，并不是所有的方向都是可行方向。

&emsp; 一阶导数必要条件（是局部或全局最优解的必要条件），对于任意的可行方向$$d$$：

&emsp; 1. 对于有约束问题(约束$$\Omega \in \mathbb{R}^n$$)：$$\Delta f(x^*)d \geq 0$$   
&emsp; 2. 对于无约束问题(约束$$\mathbb{R}^n$$)：$$\Delta f(x^*) = 0$$

&emsp; 二阶导数必要条件（是局部或全局最优解的必要条件）：

&emsp; 1. 对于有约束问题(约束$$\Omega \in \mathbb{R}^n$$)：1）$$\Delta f(x^*)d \geq 0$$ 或者 2) if $$\Delta f(x^*)d = 0, then, \ d^T \Delta^2f(x^*)d \geq 0$$，其中$$\Delta^2f(x^*)$$叫做海森矩阵$$H$$。

&emsp; 2. 对于无约束问题(约束$$\mathbb{R}^n$$)：1）$$\Delta f(x^*) = 0$$ 或者 2) $$\forall d: \ d^T \Delta^2f(x^*)d \geq 0$$(即海森矩阵是半正定的)。

&emsp; 特别的，对于无约束问题，二阶导数充分条件（是局部或全局最优解的充分条件）：1) $$\Delta f(x^*)d \geq 0$$, 2)$$H(x^*)$$是正定的。





